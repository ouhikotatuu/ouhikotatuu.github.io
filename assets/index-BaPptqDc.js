import{d as T,r as b,q as K,b as u,l as x,w as i,m as V,h as _,f as s,s as m,n as r,e as v,y as S,z as D,t as w,_ as B,x as z,o as L,c as M,i as q,F as Q,p as W,j as X}from"./index-DDqPfp3K.js";import{f as R,p as j,e as H,c as J,d as Y}from"./index-D3ZgwXXj.js";import{b as Z,c as ee,d as ae,e as G,f as te}from"./index-XXkNLdLx.js";const le={style:{display:"flex","align-items":"center",gap:"5px","flex-wrap":"nowrap"}},ne={style:{width:"100%",display:"flex","align-items":"center",gap:"10px"}},ie=T({__name:"paramEdit",emits:["flush"],setup(P,{expose:$,emit:g}){const F=g,I=b("添加"),f=b(),e=b({id:null,standardProductId:null,name:null,unit:null,type:null,typicalRangeMinimum:null,typicalRangeMaximum:null,expectation:null,remark:null}),c={name:[{required:!0,message:"请输入参数名称",trigger:"change"}],unit:[{required:!0,message:"请输入参数单位 ",trigger:"change"}],type:[{required:!0,message:"请输入参数类型 ",trigger:"change"}],expectation:[{required:!0,message:"请输入参数要求 ",trigger:"change"}]},k=(o,t)=>{o.target.value=o.target.value.replace(/\s+/g,""),e.value[t]=o.target.value},O=()=>{f.value.validate().then(async()=>{e.value.type===R("固定值")&&(e.value.typicalRangeMaximum=e.value.typicalRangeMinimum);let o;I.value==="添加"&&(o=await Z(e.value)),I.value==="编辑"&&(o=await ee(e.value)),o.affected&&(V.success(`${I.value}成功`),F("flush"),d())})};K(()=>e.value.type,o=>{e.value.typicalRangeMinimum=null,e.value.typicalRangeMaximum=null},{deep:!0});const h=b(!1),y=(o,t)=>{o&&o.id?(I.value="编辑",e.value=JSON.parse(JSON.stringify(o))):(I.value="添加",e.value={}),e.value.standardProductId=t,h.value=!0},d=()=>{var o;h.value=!1,(o=f.value)==null||o.resetFields()};return $({show:y}),(o,t)=>{const n=_("a-input"),p=_("a-form-item"),U=_("a-select"),E=_("a-form"),l=_("a-modal");return u(),x(l,{ref_key:"formRef",ref:f,open:h.value,"onUpdate:open":t[14]||(t[14]=a=>h.value=a),title:I.value,"ok-text":"确认","cancel-text":"取消",centered:"",onOk:O,onCancel:d},{default:i(()=>[s(E,{style:{padding:"0 10px 10px 0"},ref_key:"formRef",ref:f,model:e.value,rules:c,autocomplete:"off",labelCol:{sm:{span:5}},labelAlign:"right"},{default:i(()=>[s(p,{label:"参数名称：",name:"name"},{default:i(()=>[s(n,{value:e.value.name,"onUpdate:value":t[0]||(t[0]=a=>e.value.name=a),placeholder:"请输入参数名称",onChange:t[1]||(t[1]=a=>k(a,"name")),allowClear:""},null,8,["value"])]),_:1}),e.value.id?m("",!0):(u(),x(p,{key:0,label:"参数单位：",name:"unit"},{default:i(()=>[s(n,{value:e.value.unit,"onUpdate:value":t[2]||(t[2]=a=>e.value.unit=a),placeholder:"请输入参数单位",onChange:t[3]||(t[3]=a=>k(a,"unit")),allowClear:""},null,8,["value"])]),_:1})),e.value.id?m("",!0):(u(),x(p,{key:1,label:"参数类型：",name:"type"},{default:i(()=>[s(U,{value:e.value.type,"onUpdate:value":t[4]||(t[4]=a=>e.value.type=a),options:r(j),placeholder:"请选择参数类型"},null,8,["value","options"])]),_:1})),e.value.id?m("",!0):(u(),x(p,{key:2,label:"典型范围：",name:"typicalRangeMinimum"},{default:i(()=>[v("div",le,[S(v("div",null,w("≤"),512),[[D,e.value.type===r(R)("上限")]]),S(v("div",null,w("≥"),512),[[D,e.value.type===r(R)("下限")]]),v("div",ne,[S(s(n,{disabled:!e.value.type,value:e.value.typicalRangeMinimum,"onUpdate:value":t[5]||(t[5]=a=>e.value.typicalRangeMinimum=a),placeholder:e.value.type?"请输入下限":"请先先择参数类型",onChange:t[6]||(t[6]=a=>k(a,"typicalRangeMinimum")),allowClear:""},null,8,["disabled","value","placeholder"]),[[D,e.value.type===r(R)("下限")||e.value.type===r(R)("上下限")]]),S(v("div",null,"-",512),[[D,e.value.type===r(R)("上下限")]]),S(s(n,{disabled:!e.value.type,value:e.value.typicalRangeMaximum,"onUpdate:value":t[7]||(t[7]=a=>e.value.typicalRangeMaximum=a),placeholder:e.value.type?"请输入上限":"请先先择参数类型",onChange:t[8]||(t[8]=a=>k(a,"typicalRangeMaximum")),allowClear:""},null,8,["disabled","value","placeholder"]),[[D,e.value.type===r(R)("上限")||e.value.type===r(R)("上下限")]]),S(s(n,{disabled:!e.value.type,value:e.value.typicalRangeMinimum,"onUpdate:value":t[9]||(t[9]=a=>e.value.typicalRangeMinimum=a),placeholder:e.value.type?"请输入固定值":"请先先择参数类型",onChange:t[10]||(t[10]=a=>k(a,"typicalRangeMinimum")),allowClear:""},null,8,["disabled","value","placeholder"]),[[D,!e.value.type||e.value.type===r(R)("固定值")]])])])]),_:1})),e.value.id?m("",!0):(u(),x(p,{key:3,label:"参数要求：",name:"expectation"},{default:i(()=>[s(U,{value:e.value.expectation,"onUpdate:value":t[11]||(t[11]=a=>e.value.expectation=a),options:r(H),placeholder:"请选择参数要求"},null,8,["value","options"])]),_:1})),e.value.id?m("",!0):(u(),x(p,{key:4,label:"备注：",name:"remark"},{default:i(()=>[s(n,{value:e.value.remark,"onUpdate:value":t[12]||(t[12]=a=>e.value.remark=a),placeholder:"请输入备注",onChange:t[13]||(t[13]=a=>k(a,"remark")),allowClear:""},null,8,["value"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),se=B(ie,[["__scopeId","data-v-17bf484e"]]),oe=T({__name:"equipmentEdit",emits:["flush"],setup(P,{expose:$,emit:g}){const F=z(),I=g,f=b("添加"),e=b(),c=b({name:null,disabled:!1}),k={name:[{required:!0,message:"请输入参数名称",trigger:"change"}],disabled:[{required:!0,message:"请选择状态 ",trigger:"change"}]},O=[{value:!0,label:"启用"},{value:!1,label:"禁用"}],h=(n,p)=>{n.target.value=n.target.value.replace(/\s+/g,""),c.value[p]=n.target.value},y=()=>{e.value.validate().then(async()=>{let n;f.value==="添加"&&(n=await ae(c.value)),f.value==="编辑"&&(n=await G(c.value)),n.affected&&(V.success(`${f.value}成功`),I("flush"),t())})},d=b(!1),o=n=>{n&&n.id?(f.value="编辑",c.value=JSON.parse(JSON.stringify(n))):(f.value="添加",c.value={disabled:!0}),c.value.standardProductId=F.query.id,d.value=!0},t=()=>{var n;d.value=!1,(n=e.value)==null||n.resetFields()};return $({show:o}),(n,p)=>{const U=_("a-input"),E=_("a-form-item"),l=_("a-select"),a=_("a-form"),N=_("a-modal");return u(),x(N,{ref_key:"formRef",ref:e,open:d.value,"onUpdate:open":p[3]||(p[3]=C=>d.value=C),title:f.value,"ok-text":"确认","cancel-text":"取消",centered:"",onOk:y,onCancel:t},{default:i(()=>[s(a,{style:{padding:"0 10px 10px 0"},ref_key:"formRef",ref:e,model:c.value,rules:k,autocomplete:"off",labelCol:{sm:{span:6}},labelAlign:"right"},{default:i(()=>[s(E,{label:"分项设备名称：",name:"name"},{default:i(()=>[s(U,{value:c.value.name,"onUpdate:value":p[0]||(p[0]=C=>c.value.name=C),placeholder:"请输入分项设备名称",onChange:p[1]||(p[1]=C=>h(C,"name")),allowClear:""},null,8,["value"])]),_:1}),c.value.id?m("",!0):(u(),x(E,{key:0,label:"状态：",name:"disabled"},{default:i(()=>[s(l,{disabled:!c.value.id,value:c.value.disabled,"onUpdate:value":p[2]||(p[2]=C=>c.value.disabled=C),options:O,placeholder:"请选择状态"},null,8,["disabled","value"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),ue=B(oe,[["__scopeId","data-v-9cd27e1e"]]),A=P=>(W("data-v-43ea7576"),P=P(),X(),P),de={class:"page"},re={class:"block"},pe={class:"block"},me={class:"tab"},ce=A(()=>v("div",{class:"tab_title"},"标品参数",-1)),ve={class:"tab_view"},_e=A(()=>v("div",{class:"modalAlarm"}," *注意：参数添加完成后仅支持对参数名称编辑，且不可删除。请确保首次添加时参数信息录入正确。 ",-1)),fe={class:"param_table"},ye={key:0},ge={key:1},be={key:0},xe={key:1},ke={key:3,class:"table_button"},he={class:"block"},Ce={class:"tab"},we=A(()=>v("div",{class:"tab_title"},"分项设备",-1)),Re={class:"tab_view"},Ie=A(()=>v("div",{class:"modalAlarm"},"*注意：分项设备添加完成后不支持删除，请确保首次添加时分项设备信息录入正确。",-1)),Me={class:"param_table"},qe={key:0},$e={key:1,class:"table_button"},Ue={key:2,class:"table_button"},Ee=T({__name:"index",setup(P){const $=z(),g=b({id:null,parentId:null,code:null,name:null,disabled:!0,characteristics:[],children:[]}),F=b([{title:"参数名称",dataIndex:"name",align:"center"},{title:"参数单位",dataIndex:"unit",align:"center"},{title:"参数类型",dataIndex:"type",align:"center"},{title:"典型范围",dataIndex:"typicalRangeMinimum",align:"center"},{title:"参数要求",dataIndex:"expectation",align:"center"},{title:"备注",dataIndex:"remark",align:"center"},{title:"操作",dataIndex:"action",align:"center"}]),I=b([{title:"序号",dataIndex:"sn",align:"center"},{title:"分项设备名称",dataIndex:"name",align:"center"},{title:"状态",dataIndex:"disabled",align:"center"},{title:"操作",dataIndex:"action",align:"center"}]),f=b(null),e=y=>{f.value.show(y,g.value.id)},c=b(null),k=y=>{c.value.show(y,g.value.id)},O=async(y,d)=>{const o=d?"禁用":"启用";y.disabled=d,await G(y)&&(V.success(`${o}成功`),h())},h=async()=>{var y;await te((y=$.query)==null?void 0:y.id).then(d=>{g.value=d})};return L(()=>{h()}),(y,d)=>{const o=_("a-descriptions-item"),t=_("a-descriptions"),n=_("a-button"),p=_("a-table"),U=_("a-tag"),E=_("a-popconfirm");return u(),M("div",de,[v("div",re,[s(t,{title:"基础信息",column:5},{default:i(()=>[s(o,{label:"标品编号"},{default:i(()=>{var l;return[q(w((l=g.value)==null?void 0:l.code),1)]}),_:1}),s(o,{label:"标品名称"},{default:i(()=>{var l;return[q(w((l=g.value)==null?void 0:l.name),1)]}),_:1})]),_:1})]),v("div",pe,[v("div",me,[ce,s(n,{class:"main_button",type:"primary",onClick:d[0]||(d[0]=l=>e())},{default:i(()=>[q("添加")]),_:1})]),v("div",ve,[_e,v("div",fe,[s(p,{columns:F.value,"data-source":g.value.characteristics,pagination:!1},{bodyCell:i(({record:l,column:a,index:N})=>[a.title==="参数类型"?(u(),M("div",ye,w(r(J)(r(j),l.type)),1)):m("",!0),a.title==="参数要求"?(u(),M("div",ge,w(r(J)(r(H),l.expectation)),1)):m("",!0),a.title==="典型范围"?(u(),M(Q,{key:2},[l.type!==r(R)("上下限")?(u(),M("div",be,w(r(Y)(l.type))+w(l.typicalRangeMinimum??l.typicalRangeMaximum),1)):m("",!0),l.type===r(R)("上下限")?(u(),M("div",xe,w(l.typicalRangeMinimum)+" - "+w(l.typicalRangeMaximum),1)):m("",!0)],64)):m("",!0),a.title==="操作"?(u(),M("div",ke,[s(n,{type:"primary",onClick:C=>e(l)},{default:i(()=>[q("编辑")]),_:2},1032,["onClick"])])):m("",!0)]),_:1},8,["columns","data-source"])])])]),v("div",he,[v("div",Ce,[we,s(n,{class:"main_button",type:"primary",onClick:d[1]||(d[1]=l=>k())},{default:i(()=>[q("添加")]),_:1})]),v("div",Re,[Ie,v("div",Me,[s(p,{columns:I.value,"data-source":g.value.children.map(l=>({id:l.id,name:l.name,disabled:l.disabled})),pagination:!1},{bodyCell:i(({record:l,column:a,index:N})=>[a.title==="序号"?(u(),M("div",qe,w(N+1),1)):m("",!0),a.title==="状态"?(u(),M("div",$e,[l.disabled?m("",!0):(u(),x(U,{key:0,color:"green",style:{"font-size":"14px"}},{default:i(()=>[q("启用")]),_:1})),l.disabled?(u(),x(U,{key:1,color:"orange",style:{"font-size":"14px"}},{default:i(()=>[q("禁用")]),_:1})):m("",!0)])):m("",!0),a.title==="操作"?(u(),M("div",Ue,[s(n,{type:"primary",onClick:C=>k(l)},{default:i(()=>[q("编辑")]),_:2},1032,["onClick"]),l.disabled?(u(),x(E,{key:0,title:"请确认是否启用","ok-text":"是","cancel-text":"否",onConfirm:C=>O(l,!1)},{default:i(()=>[s(n,{type:"primary"},{default:i(()=>[q("启用")]),_:1})]),_:2},1032,["onConfirm"])):m("",!0),l.disabled?m("",!0):(u(),x(E,{key:1,title:"请确认是否禁用","ok-text":"是","cancel-text":"否",onConfirm:C=>O(l,!0)},{default:i(()=>[s(n,{type:"dashed"},{default:i(()=>[q("禁用")]),_:1})]),_:2},1032,["onConfirm"]))])):m("",!0)]),_:1},8,["columns","data-source"])])])]),s(r(se),{ref_key:"paramEditDom",ref:f,onFlush:d[2]||(d[2]=l=>{var a;return h(g.value.id??((a=r($).query)==null?void 0:a.id))})},null,512),s(r(ue),{ref_key:"equipmentEditDom",ref:c,onFlush:d[3]||(d[3]=l=>{var a;return h(g.value.id??((a=r($).query)==null?void 0:a.id))})},null,512)])}}}),De=B(Ee,[["__scopeId","data-v-43ea7576"]]);export{De as default};
