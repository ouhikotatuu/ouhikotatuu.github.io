import{l as U,r as M,v as Y,c as D}from"./index-DpN2cfQ8.js";import{s as E,a as P,b as j}from"./index-pgNKrUaX.js";import{d as O,r as c,b as v,l as J,w as l,m as B,a as H,h as u,f as t,n as o,_ as N,q as L,o as Q,c as m,e as G,i as S,s as x,v as h,x as q}from"./index-DWXe3opJ.js";const K=O({__name:"supplierAdd",setup(V,{expose:n}){const _=c(),d=c({name:null,level:null,rating:null}),k={name:[{required:!0,message:"请输入供应商名称",trigger:"change"}],level:[{required:!0,message:"请选择供应商层级",trigger:"change"}],rating:[{required:!0,message:"请选择供应商评级",trigger:"change"}]},I=()=>{_.value.validate().then(async()=>{const i=await E(d.value);i.affected&&(B.success("新建成功"),b(),H.push({path:"/supplier_info",query:{id:i.id}}))})},f=c(!1),A=()=>{f.value=!0},b=()=>{var i;f.value=!1,(i=_.value)==null||i.resetFields()};return n({show:A}),(i,p)=>{const s=u("a-input"),a=u("a-form-item"),C=u("a-select"),g=u("a-form"),w=u("a-modal");return v(),J(w,{ref_key:"formRef",ref:_,open:f.value,"onUpdate:open":p[3]||(p[3]=r=>f.value=r),title:"新建","ok-text":"确认","cancel-text":"取消",centered:"",onOk:I,onCancel:b},{default:l(()=>[t(g,{style:{padding:"10px"},ref_key:"formRef",ref:_,model:d.value,rules:k,autocomplete:"off"},{default:l(()=>[t(a,{label:"供应商名称：",name:"name"},{default:l(()=>[t(s,{value:d.value.name,"onUpdate:value":p[0]||(p[0]=r=>d.value.name=r),valueModifiers:{trim:!0},placeholder:"请输入供应商名称",allowClear:""},null,8,["value"])]),_:1}),t(a,{label:"供应商层级：",name:"level"},{default:l(()=>[t(C,{value:d.value.level,"onUpdate:value":p[1]||(p[1]=r=>d.value.level=r),options:o(U),placeholder:"请选择供应商层级"},null,8,["value","options"])]),_:1}),t(a,{label:"供应商评级：",name:"rating"},{default:l(()=>[t(C,{value:d.value.rating,"onUpdate:value":p[2]||(p[2]=r=>d.value.rating=r),options:o(M),placeholder:"请选择供应商评级"},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}}),W=N(K,[["__scopeId","data-v-5068240c"]]),X={class:"supplier-page"},Z={class:"table"},ee={key:0},te={key:1},ae={key:2},le={key:3},ne={key:4},oe={key:5},se={key:6,class:"table_button"},ue=O({__name:"index",setup(V){const n=c({name:null,code:null,validateStatus:null,rating:null,level:null}),_=c([]),d=c([{title:"序号",dataIndex:"sn",align:"center"},{title:"供应商名称",dataIndex:"name",align:"center"},{title:"供应商编号",dataIndex:"code",align:"center"},{title:"供应商认证状态",dataIndex:"validateStatus",align:"center"},{title:"供应商评级",dataIndex:"rating",align:"center"},{title:"供应商层级",dataIndex:"level",align:"center"},{title:"创建时间",dataIndex:"createdAt",align:"center"},{title:"更新时间",dataIndex:"updateAt",align:"center"},{title:"操作",dataIndex:"action",align:"center"}]);c({showQuickJumper:!0,showSizeChanger:!0,hideOnSinglePage:!1,responsive:!0,showTotal:null,size:"large",total:0});const k=()=>{i()},I=s=>{H.push({path:"/supplier_info",query:{id:s}})},f=c(null),A=()=>{f.value.show()},b=(s,a)=>{s.target.value=s.target.value.replace(/\s+/g,""),form.value[a]=s.target.value},i=async()=>{await P(n.value).then(s=>{_.value=s.records})},p=async s=>{(await j(s)).affected&&(B.success("删除成功"),i())};return L(()=>n.value,()=>{i()},{deep:!0}),Q(()=>{i()}),(s,a)=>{const C=u("a-input"),g=u("a-form-item"),w=u("a-select"),r=u("a-button"),F=u("a-form"),R=u("a-popconfirm"),T=u("a-table");return v(),m("div",X,[t(F,{class:"search_form",autocomplete:"off"},{default:l(()=>[t(g,{label:"供应商名称："},{default:l(()=>[t(C,{style:{width:"170px"},value:n.value.name,"onUpdate:value":a[0]||(a[0]=e=>n.value.name=e),valueModifiers:{trim:!0},placeholder:"请输入名称",allowClear:"",onChange:a[1]||(a[1]=e=>b(e,"name"))},null,8,["value"])]),_:1}),t(g,{label:"供应商编号："},{default:l(()=>[t(C,{style:{width:"170px"},value:n.value.code,"onUpdate:value":a[2]||(a[2]=e=>n.value.code=e),valueModifiers:{trim:!0},placeholder:"请输入编号",allowClear:"",onChange:a[3]||(a[3]=e=>b(e,"code"))},null,8,["value"])]),_:1}),t(g,{label:"供应商认证状态："},{default:l(()=>[t(w,{style:{width:"170px"},value:n.value.validateStatus,"onUpdate:value":a[4]||(a[4]=e=>n.value.validateStatus=e),options:o(Y),allowClear:"",placeholder:"请选择认证状态"},null,8,["value","options"])]),_:1}),t(g,{label:"供应商评级："},{default:l(()=>[t(w,{style:{width:"170px"},value:n.value.rating,"onUpdate:value":a[5]||(a[5]=e=>n.value.rating=e),options:o(M),allowClear:"",placeholder:"请选择评级"},null,8,["value","options"])]),_:1}),t(g,{label:"供应商层级："},{default:l(()=>[t(w,{style:{width:"170px"},value:n.value.level,"onUpdate:value":a[6]||(a[6]=e=>n.value.level=e),options:o(U),allowClear:"",placeholder:"请选择层级"},null,8,["value","options"])]),_:1}),t(r,{class:"main_button",type:"primary",onClick:A},{default:l(()=>[S("新建")]),_:1})]),_:1}),G("div",Z,[t(T,{columns:d.value,pagination:!1,"data-source":_.value,onChange:k},{bodyCell:l(({record:e,column:y,index:$})=>[y.title==="序号"?(v(),m("div",ee,x($+1),1)):h("",!0),y.title==="供应商认证状态"?(v(),m("div",te,x(o(D)(o(Y),e.validateStatus)),1)):h("",!0),y.title==="供应商评级"?(v(),m("div",ae,x(o(D)(o(M),e.rating)),1)):h("",!0),y.title==="供应商层级"?(v(),m("div",le,x(o(D)(o(U),e.level)),1)):h("",!0),y.title==="创建时间"?(v(),m("div",ne,x(e.createdAt?o(q)(e.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"),1)):h("",!0),y.title==="更新时间"?(v(),m("div",oe,x(e.updateAt?o(q)(e.updateAt).format("YYYY-MM-DD HH:mm:ss"):"-"),1)):h("",!0),y.title==="操作"?(v(),m("div",se,[t(r,{type:"primary",onClick:z=>I(e==null?void 0:e.id)},{default:l(()=>[S("查看详情")]),_:2},1032,["onClick"]),t(R,{title:"请确认是否删除","ok-text":"是","cancel-text":"否",onConfirm:z=>p(e==null?void 0:e.id)},{default:l(()=>[t(r,{type:"primary",danger:""},{default:l(()=>[S("删除")]),_:1})]),_:2},1032,["onConfirm"])])):h("",!0)]),_:1},8,["columns","data-source"])]),t(W,{ref_key:"addDom",ref:f},null,512)])}}}),pe=N(ue,[["__scopeId","data-v-fd24ce69"]]);export{pe as default};
