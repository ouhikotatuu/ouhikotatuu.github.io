import{u as Y,e as Z}from"./exportToExcel-BUpgOtO1.js";import{D as z,d as V,a as k,r as F,p as X,b as u,c as p,q as B,w as n,g as e,l as I,e as T,v as A,F as $,M as q,z as P,o as h,A as ee,f as w,x as j,C as te,j as M,B as ae,_ as ne}from"./index-DHTjKAgc.js";function le(_){return z({url:"/instruments/instrument/pageItem",method:"GET",params:_})}function G(_){return z({url:"/instruments/instrument/saveOrUpdate",method:"POST",data:_})}function oe(_){return z({url:"/instruments/instrument",method:"DELETE",params:_})}const se=V({__name:"DeviceMangeAdd",props:{tableData:Array},emits:["save"],setup(_,{expose:i,emit:g}){const d=k(!1),l=F({id:"",insSerialNumber:"",insName:"",systemId:null,marketId:null,insBriefInformation:""}),b=k(null),x={insSerialNumber:[{required:!0,message:"请输入仪器SN号码",trigger:"blur"}],insName:[{required:!0,message:"请输入仪器名称",trigger:"blur"}],systemId:[{required:!0,message:"请选择归属系统",trigger:"change"}],marketId:[{required:!0,message:"请选择归属市场",trigger:"change"}]},c=_,R=g;i({begin:()=>{var o;(o=b.value)==null||o.resetFields(),l.insBriefInformation="",X(()=>{d.value=!0})},end:()=>{d.value=!1}});const O=()=>{q.confirm({title:"确定取消",content:"是否确定取消操作？",okText:"确定",cancelText:"取消",onOk:()=>{d.value=!1}})},m=async()=>{var o;await((o=b.value)==null?void 0:o.validate()),R("save",l)};return(o,r)=>{const f=u("a-input"),y=u("a-form-item"),N=u("a-select-option"),C=u("a-select"),S=u("a-form"),D=u("a-button"),s=u("a-modal");return p(),B(s,{open:d.value,"onUpdate:open":r[5]||(r[5]=t=>d.value=t),title:"设备添加"},{footer:n(()=>[e(D,{onClick:O},{default:n(()=>r[6]||(r[6]=[I("取消")])),_:1}),e(D,{type:"primary",onClick:m},{default:n(()=>r[7]||(r[7]=[I("确定")])),_:1})]),default:n(()=>[e(S,{model:l,ref_key:"formRef",ref:b,rules:x},{default:n(()=>[e(y,{label:"仪器SN号码",name:"insSerialNumber"},{default:n(()=>[e(f,{value:l.insSerialNumber,"onUpdate:value":r[0]||(r[0]=t=>l.insSerialNumber=t),placeholder:"请输入仪器SN号码"},null,8,["value"])]),_:1}),e(y,{label:"仪器名称",name:"insName"},{default:n(()=>[e(f,{value:l.insName,"onUpdate:value":r[1]||(r[1]=t=>l.insName=t),placeholder:"请输入仪器名称"},null,8,["value"])]),_:1}),e(y,{label:"仪器归属系统",name:"systemId"},{default:n(()=>[e(C,{value:l.systemId,"onUpdate:value":r[2]||(r[2]=t=>l.systemId=t),placeholder:"请选择仪器归属系统"},{default:n(()=>[(p(!0),T($,null,A(c.tableData,t=>(p(),B(N,{key:t.id,label:t.systemId,value:t.systemId},null,8,["label","value"]))),128))]),_:1},8,["value"])]),_:1}),e(y,{label:"仪器归属市场",name:"marketId"},{default:n(()=>[e(C,{value:l.marketId,"onUpdate:value":r[3]||(r[3]=t=>l.marketId=t),placeholder:"请选择仪器归属市场"},{default:n(()=>[(p(!0),T($,null,A(c.tableData,t=>(p(),B(N,{key:t.id,label:t.marketId,value:t.marketId},null,8,["label","value"]))),128))]),_:1},8,["value"])]),_:1}),e(y,{label:"简要信息"},{default:n(()=>[e(f,{value:l.insBriefInformation,"onUpdate:value":r[4]||(r[4]=t=>l.insBriefInformation=t),placeholder:"请输入简要信息"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}}),re=V({__name:"DeviceMangeEdit",props:{tableData:Array},emits:["save"],setup(_,{expose:i,emit:g}){const d=k(!1),l=F({id:"",insSerialNumber:"",insName:"",systemId:"",marketId:"",insBriefInformation:""}),b=k(null),x=_,c=g;i({begin:m=>{l.id=m.id,l.insSerialNumber=m.insSerialNumber,l.insName=m.insName,l.systemId=m.systemId,l.marketId=m.marketId,l.insBriefInformation=m.insBriefInformation,console.log(m),X(()=>{d.value=!0})},end:()=>{d.value=!1}});const R=()=>{q.confirm({title:"确定取消",content:"是否确定取消操作？",okText:"确定",cancelText:"取消",onOk:()=>{d.value=!1}})},O=async()=>{var m;await((m=b.value)==null?void 0:m.validate()),c("save",l)};return(m,o)=>{const r=u("a-input"),f=u("a-form-item"),y=u("a-select-option"),N=u("a-select"),C=u("a-form"),S=u("a-button"),D=u("a-modal");return p(),B(D,{open:d.value,"onUpdate:open":o[5]||(o[5]=s=>d.value=s),title:"设备修改"},{footer:n(()=>[e(S,{onClick:R},{default:n(()=>o[6]||(o[6]=[I("取消")])),_:1}),e(S,{type:"primary",onClick:O},{default:n(()=>o[7]||(o[7]=[I("确定")])),_:1})]),default:n(()=>[e(C,{model:l,ref_key:"formRef",ref:b},{default:n(()=>[e(f,{label:"仪器SN号码"},{default:n(()=>[e(r,{value:l.insSerialNumber,"onUpdate:value":o[0]||(o[0]=s=>l.insSerialNumber=s)},null,8,["value"])]),_:1}),e(f,{label:"仪器名称"},{default:n(()=>[e(r,{value:l.insName,"onUpdate:value":o[1]||(o[1]=s=>l.insName=s)},null,8,["value"])]),_:1}),e(f,{label:"仪器归属系统"},{default:n(()=>[e(N,{value:l.systemId,"onUpdate:value":o[2]||(o[2]=s=>l.systemId=s)},{default:n(()=>[(p(!0),T($,null,A(x.tableData,s=>(p(),B(y,{key:s.id,label:s.systemId,value:s.systemId},null,8,["label","value"]))),128))]),_:1},8,["value"])]),_:1}),e(f,{label:"仪器归属市场"},{default:n(()=>[e(N,{value:l.marketId,"onUpdate:value":o[3]||(o[3]=s=>l.marketId=s)},{default:n(()=>[(p(!0),T($,null,A(x.tableData,s=>(p(),B(y,{key:s.id,label:s.marketId,value:s.marketId},null,8,["label","value"]))),128))]),_:1},8,["value"])]),_:1}),e(f,{label:"简要信息"},{default:n(()=>[e(r,{value:l.insBriefInformation,"onUpdate:value":o[4]||(o[4]=s=>l.insBriefInformation=s)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}}),ue={class:"product_device_page"},ie={class:"table_form_view"},de={class:"table_action_view"},me={class:"table_search_handler"},ce={class:"table_action_button"},fe={class:"table_title"},pe={class:"table_title_icon"},ve=V({__name:"index",setup(_){const i=F({current:1,size:10,instrumentName:null,systemId:null,marketId:null}),g=P([]),d=P(0),l=k(null),b=k(null),x=k(null);h(async()=>{c()});const c=async()=>{const t=await le(i);g.value=t.records,d.value||(d.value=t.total||0)},R=async()=>{c()},O=()=>{i.instrumentName=null,i.marketId=null,i.systemId=null,c()},m=async t=>{var a;await G(t),(a=x.value)==null||a.end(),c(),M.success("新增成功")},o=async t=>{var a;await G(t),(a=b.value)==null||a.end(),c(),M.success("修改成功")},r=async t=>{await oe({ids:t}).then(a=>{a.code===200?q.confirm({title:"确定删除？",content:"此操作不可撤销，请确认是否删除!!!",okText:"确认",cancelText:"取消",onOk:async()=>{c(),M.success("删除成功")},onCancel(){M.error("操作已取消")}}):q.info({title:"操作提示",content:"无法删除，仅可修改。",onOk(){}})})},f=[{title:"序号",customRender:({text:t,record:a,index:H})=>`${H+1}`,align:"center",width:150},{title:"仪器ID",dataIndex:"id",align:"center",width:150},{title:"仪器SN号码",dataIndex:"insSerialNumber",align:"center"},{title:"仪器名称",dataIndex:"insName",align:"center"},{title:"仪器归属系统",dataIndex:"systemId",align:"center"},{title:"仪器归属市场",dataIndex:"marketId",align:"center"},{title:"简要信息",dataIndex:"insBriefInformation",align:"center"},{title:"操作",dataIndex:"action",align:"center"}],y=()=>{const t=["操作","序号"];return[...f.filter(a=>!t.includes(a.title))]},N=k([]),C=k([]),S=ee(()=>({selectedRowKeys:N.value,onChange:(t,a)=>{N.value=t,C.value=a}})),D=()=>{q.confirm({title:"确定导出选中数据吗？",content:"导出后无法修改，请确认是否导出？",okText:"确定",cancelText:"取消",onOk:()=>{Z(C.value.map((t,a)=>({...t,sn:a})),y(),"selectedData.xlsx")}})},s=t=>{console.log(t),i.current=t.current,i.size=t.pageSize,c()};return(t,a)=>{const H=u("a-input"),K=u("a-form-item"),J=u("a-form"),U=u("a-button"),Q=u("a-table");return p(),T("div",ue,[w("div",ie,[e(J,{class:"search_form",layout:"inline",autocomplete:"off",model:l.value},{default:n(()=>[e(K,{label:"仪器种类"},{default:n(()=>[e(H,{placeholder:"请输入仪器种类",value:i.instrumentName,"onUpdate:value":a[0]||(a[0]=v=>i.instrumentName=v)},null,8,["value"])]),_:1}),e(K,{label:"归宿系统"},{default:n(()=>[e(H,{placeholder:"请输入归宿系统",value:i.systemId,"onUpdate:value":a[1]||(a[1]=v=>i.systemId=v)},null,8,["value"])]),_:1}),e(K,{label:"市场名"},{default:n(()=>[e(H,{placeholder:"请输入市场名",value:i.marketId,"onUpdate:value":a[2]||(a[2]=v=>i.marketId=v)},null,8,["value"])]),_:1})]),_:1},8,["model"]),w("div",de,[w("div",me,[e(U,{class:"table_search_button",type:"primary",onClick:a[3]||(a[3]=v=>R())},{default:n(()=>a[5]||(a[5]=[I("查询")])),_:1}),e(U,{class:"table_search_clean_button",type:"primary",onClick:O},{default:n(()=>a[6]||(a[6]=[I("清除")])),_:1}),e(U,{class:"table_search_export_button",type:"primary",onClick:D},{default:n(()=>a[7]||(a[7]=[I("导出信息")])),_:1})]),w("div",ce,[e(U,{class:"table_action_add",type:"primary",onClick:a[4]||(a[4]=v=>{var E;return(E=x.value)==null?void 0:E.begin()})},{default:n(()=>a[8]||(a[8]=[I(" 设备增加 ")])),_:1})])])]),w("div",fe,[w("div",pe,[e(j(te))]),a[9]||(a[9]=w("div",{class:"table_title_text"},"菜单名称",-1))]),e(Q,{columns:f,"data-source":g.value,pagination:j(Y)(d.value),"row-selection":S.value,rowKey:v=>v.id,onChange:s},{bodyCell:n(({column:v,record:E})=>[v.dataIndex==="action"?(p(),T($,{key:0},[e(U,{class:"no-border-button",type:"primary",ghost:"",danger:"",onClick:W=>r(E.id)},{default:n(()=>a[10]||(a[10]=[I("删除")])),_:2},1032,["onClick"]),e(U,{class:"no-border-button",type:"primary",ghost:"",onClick:W=>{var L;return(L=b.value)==null?void 0:L.begin(E)}},{default:n(()=>a[11]||(a[11]=[I("修改")])),_:2},1032,["onClick"])],64)):ae("",!0)]),_:1},8,["data-source","pagination","row-selection","rowKey"]),e(se,{ref_key:"addRef",ref:x,onSave:m,tableData:g.value},null,8,["tableData"]),e(re,{ref_key:"updateRef",ref:b,onSave:o,tableData:g.value},null,8,["tableData"])])}}}),ye=ne(ve,[["__scopeId","data-v-5e14fc7e"]]);export{ye as default};
